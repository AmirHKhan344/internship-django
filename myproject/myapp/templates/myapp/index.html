<!-- In index.html -->
{% extends "myapp/base.html" %}
{% load static %}
{% load model_extras %}

{% block content %}

<div class="dash-bg">

  <!-- Search (optional) -->
  <form method="get" class="searchbar glass-card" style="margin-bottom:16px;">
    <input type="text" name="q" value="{{ q }}" placeholder="Search PO, vendor, batch, mine..." />
    <button type="submit">Search</button>
  </form>

  <h2 class="section-title">Reports and Dashboard</h2>
  

  <h2 class="section-title">Quick Actions</h2>
  <div class="card-grid three">
    <a class="qa-card" href="{% url 'upload_po' %}"><div class="qa-top"><h3>Upload PO</h3><span class="arrow">→</span></div><p>Process purchase order documents</p></a>
    <a class="qa-card" href="{% url 'upload_coal' %}"><div class="qa-top"><h3>Upload coal analysis reports</h3><span class="arrow">→</span></div><p>Process coal analysis reports</p></a>
  </div>

  <!-- ======================= -->
  <!--   Database -> Tables    -->
  <!-- ======================= -->

  <h2 class="section-title">Purchase Orders</h2>
  <div class="glass-card">
    <div class="table-wrap">
      <table class="data-table">
        <thead>
          <tr>
            {% for h in po_headers %}
              <th>{{ h|title|cut:"_" }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in po_page %}
          <tr>
            {% for h in po_headers %}
              <td>{{ row|attr:h }}</td>
            {% endfor %}
          </tr>
          {% empty %}
          <tr><td colspan="{{ po_headers|length }}">No records found.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="pager">
      {% if po_page.has_previous %}
        <a href="?po_page={{ po_page.previous_page_number }}&q={{ q }}">Prev</a>
      {% endif %}
      <span>Page {{ po_page.number }} / {{ po_page.paginator.num_pages }}</span>
      {% if po_page.has_next %}
        <a href="?po_page={{ po_page.next_page_number }}&q={{ q }}">Next</a>
      {% endif %}
    </div>
  </div>

  <h2 class="section-title">Coal Analysis</h2>
  <div class="glass-card">
    <div class="table-wrap">
      <table class="data-table">
        <thead>
          <tr>
            {% for h in coal_headers %}
              <th>{{ h|title|cut:"_" }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in coal_page %}
          <tr>
            {% for h in coal_headers %}
              <td>{{ row|attr:h }}</td>
            {% endfor %}
          </tr>
          {% empty %}
          <tr><td colspan="{{ coal_headers|length }}">No records found.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="pager">
      {% if coal_page.has_previous %}
        <a href="?coal_page={{ coal_page.previous_page_number }}&q={{ q }}">Prev</a>
      {% endif %}
      <span>Page {{ coal_page.number }} / {{ coal_page.paginator.num_pages }}</span>
      {% if coal_page.has_next %}
        <a href="?coal_page={{ coal_page.next_page_number }}&q={{ q }}">Next</a>
      {% endif %}
    </div>
  </div>

</div>
{% endblock %}
